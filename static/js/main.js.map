{"version":3,"sources":["webpack:///webpack/bootstrap 9b2afd955b75fd55413b","webpack:///./assets/js/main.js","webpack:///./assets/js/game.js","webpack:///./assets/js/engine.js","webpack:///./assets/js/nodes/move.js","webpack:///./assets/js/nodes/render.js","webpack:///./assets/js/nodes/control.js","webpack:///./assets/js/nodes/collision.js","webpack:///./assets/js/entity.js","webpack:///./assets/js/components/display.js","webpack:///./assets/js/components/position.js","webpack:///./assets/js/components/velocity.js","webpack:///./assets/js/components/input.js","webpack:///./assets/js/components/collision.js","webpack:///./assets/js/systems/move.js","webpack:///./assets/js/systems/render.js","webpack:///./assets/js/systems/control.js","webpack:///./assets/js/systems/collision.js","webpack:///./assets/js/data/player.js","webpack:///./assets/js/data/settings.js","webpack:///./assets/js/data/map.js","webpack:///./assets/js/components/animation.js","webpack:///./assets/js/systems/animation.js","webpack:///./assets/js/nodes/animation.js"],"names":["game","init","Game","engine","renderer","PIXI","loader","add","load","onLoad","bind","settings","addSystem","getLevelData","then","createLevel","level","createPlayer","start","map","data","mapData","layers","sky","createSkyEntity","width","height","tileheight","addEntity","i","j","k","l","val","ground","createGroundEntity","tilewidth","tile","texture","Texture","utils","TextureCache","Rectangle","thing","Sprite","display","sprite","addComponent","positionComponent","x","y","collision","type","player","animation","walkRight","walkLeft","jump","default","isFocus","TILE","velocityComponent","accelerationY","GRAVITY","inputComponent","Engine","entities","systems","nodes","isPaused","update","entity","push","position","entityId","id","class","velocity","input","control","index","indexOf","splice","length","system","stop","nodeClass","before","document","visibilityState","now","performance","dt","Math","min","getNodes","requestAnimationFrame","MoveNode","RenderNode","displayComponent","ControlNode","CollisionNode","collisionComponent","Entity","generateUUID","flag_kill","d","Date","getTime","window","uuid","replace","c","r","random","floor","toString","component","componentClass","DisplayComponent","PositionComponent","VelocityComponent","accelerationX","maxAccelerationX","maxAccelerationY","velocityX","velocityY","InputComponent","CollisionComponent","collide","MoveSystem","time","node","velocityData","positionData","isGrounded","FRICTION","max","MAP","RenderSystem","sprites","stage","container","Stage","Container","addChild","autoDetectRenderer","body","appendChild","view","hasOwnProperty","mapWidth","mapHeight","screenWidth","screenHeight","pivotX","pivot","pivotY","console","log","Object","keys","render","ControlSystem","e","key","keyCode","isJump","KEY","SPACE","isLeft","LEFT","isUp","UP","isRight","RIGHT","isDown","DOWN","addEventListener","onKeyDown","onKeyUp","removeEventListener","CollisionSystem","sprite1","sprite2","isCollision","primaries","filter","secondaries","primary","secondary","errorMargin","isBottomCollision","isTopCollision","isRightCollision","isLeftCollision","PlayerData","frame","SettingsData","MapData","getSprite","levels","url","currentLevel","getData","levelData","fetch","response","json","AnimationComponent","currentAnimationProp","currentFrame","AnimationSystem","timer","prop","animationData","displayData","frames","setAnimation","updateFrame","AnimationNode","animationComponent"],"mappings":"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","file":"js/main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 9b2afd955b75fd55413b","\nimport Game from './game';\n\nlet game = new Game();\ngame.init();\n\n\n\n// WEBPACK FOOTER //\n// ./assets/js/main.js","import Engine from './engine';\nimport Entity from './entity';\n\nimport DisplayComponent from './components/display';\nimport PositionComponent from './components/position';\nimport VelocityComponent from './components/velocity';\nimport InputComponent from './components/input';\nimport CollisionComponent from './components/collision';\nimport AnimationComponent from './components/animation';\n\nimport MoveSystem from './systems/move';\nimport RenderSystem from './systems/render';\nimport ControlSystem from './systems/control';\nimport CollisionSystem from './systems/collision';\nimport AnimationSystem from './systems/animation';\n\nimport PlayerData from './data/player';\nimport SettingsData from './data/settings';\nimport MapData from './data/map';\n\nexport default class Game {\n\n    constructor() {\n\n        this.engine = {};\n\n        this.renderer = {};\n    }\n\n    init() {\n\n        PIXI.loader.add('player', '/static/img/player.png');\n\n        PIXI.loader.add('blue', '/static/img/blue.png');\n\n        PIXI.loader.add('bg', '/static/img/bg.png');\n\n        PIXI.loader.load(this.onLoad.bind(this));\n    }\n\n    onLoad() {\n\n        this.settings = new SettingsData();\n\n        this.engine = new Engine();\n\n        this.engine.addSystem(new AnimationSystem(this.settings));\n\n        this.engine.addSystem(new MoveSystem(this.settings));\n\n        this.engine.addSystem(new RenderSystem(this.settings));\n\n        this.engine.addSystem(new ControlSystem(this.settings));\n\n        this.engine.addSystem(new CollisionSystem(this.settings));\n\n        this.getLevelData()\n        .then(this.createLevel.bind(this))\n        .then((level) => {\n            this.createPlayer(this.settings, level.start);\n            this.engine.init();\n        });\n    }\n\n    getLevelData() {\n\n        let map = new MapData();\n\n        return map.level;\n    }\n\n    createLevel(level) {\n\n        let data = level.data;\n\n        let mapData = level.data.layers[0].data;\n\n        let sky = this.createSkyEntity(data.width, data.height, data.tileheight);\n\n        this.engine.addEntity(sky);\n\n        for (var i = 0, j = data.height; i < j; i++) {\n\n            for (var k = 0, l = data.width; k < l; k++) {\n\n                let val = mapData[i * data.width + k];\n\n                if (val === 1) {\n\n                    let ground = this.createGroundEntity(k * data.tilewidth, i * data.tilewidth, data.tileheight);\n\n                    this.engine.addEntity(ground);\n                }\n            }\n        }\n\n        return level;\n    }\n\n    createSkyEntity(width, height, tile) {\n\n        let sky = new Entity();\n\n        let texture = new PIXI.Texture(PIXI.utils.TextureCache['bg'], new PIXI.Rectangle(33, 0, 14, tile));\n\n        let thing = new PIXI.Sprite(texture);\n\n        thing.height = height * tile;\n        thing.width = width * tile;\n\n        let display = new DisplayComponent({ sprite: thing });\n\n        sky.addComponent(display);\n\n        let positionComponent = new PositionComponent();\n\n        positionComponent.x = 0;\n        positionComponent.y = 0;\n\n        sky.addComponent(positionComponent);\n\n        return sky;\n    }\n\n    createGroundEntity(x, y, tile) {\n\n        let ground = new Entity();\n\n        let texture = new PIXI.Texture(PIXI.utils.TextureCache['bg'], new PIXI.Rectangle(0, 0, 14, tile));\n\n        let thing = new PIXI.Sprite(texture);\n\n        thing.height = tile;\n        thing.width = tile;\n\n        let display = new DisplayComponent({ sprite: thing });\n\n        ground.addComponent(display);\n\n        let positionComponent = new PositionComponent();\n\n        positionComponent.x = x;\n        positionComponent.y = y;\n\n        ground.addComponent(positionComponent);\n\n        let collision = new CollisionComponent();\n\n        collision.type = 'secondary';\n\n        ground.addComponent(collision);\n\n        return ground;\n    }\n\n    createPlayer(settings, start) {\n\n        let data = new PlayerData();\n\n        let player = new Entity();\n\n        let animation = new AnimationComponent();\n\n        animation.walkRight = [1, 2];\n\n        animation.walkLeft = [2, 1];\n\n        animation.jump = [3];\n\n        animation.default = [0];\n\n        player.addComponent(animation);\n\n        let collision = new CollisionComponent();\n\n        collision.type = 'primary';\n\n        player.addComponent(collision);\n\n        let display = new DisplayComponent(data);\n\n        display.isFocus = true;\n\n        player.addComponent(display);\n\n        let positionComponent = new PositionComponent();\n\n        positionComponent.x = start[0] * settings.TILE;\n        positionComponent.y = start[1] * settings.TILE;\n\n        player.addComponent(positionComponent);\n\n        let velocityComponent = new VelocityComponent();\n\n        velocityComponent.accelerationY = settings.GRAVITY;\n\n        player.addComponent(velocityComponent);\n\n        let inputComponent = new InputComponent();\n\n        player.addComponent(inputComponent);\n\n        this.engine.addEntity(player);\n    }\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./assets/js/game.js","import MoveNode from './nodes/move';\nimport RenderNode from './nodes/render';\nimport ControlNode from './nodes/control';\nimport CollisionNode from './nodes/collision';\nimport AnimationNode from './nodes/animation';\n\nexport default class Engine {\n\n    constructor() {\n\n        this.entities = [];\n        this.systems = [];\n        this.nodes = [];\n        this.isPaused = false;\n    }\n\n    init() {\n\n        this.update();\n    }\n\n    addEntity(entity) {\n\n        this.entities.push(entity);\n\n        if (entity.display && entity.position) {\n\n            this.nodes.push({ entityId: entity.id, class: 'render', data: new RenderNode(entity.id, entity.display, entity.position) });\n        }\n\n        if (entity.animation && entity.display && entity.velocity) {\n\n            this.nodes.push({ entityId: entity.id, class: 'animation', data: new AnimationNode(entity.id, entity.animation, entity.display, entity.velocity) });\n        }\n\n        if (entity.velocity && entity.position) {\n\n            this.nodes.push({ entityId: entity.id, class: 'move', data: new MoveNode(entity.id, entity.position, entity.velocity) });\n        }\n\n        if (entity.velocity && entity.input) {\n\n            this.nodes.push({ entityId: entity.id, class: 'control', data: new ControlNode(entity.id, entity.control, entity.velocity) });\n        }\n\n        if (entity.collision) {\n\n            this.nodes.push({ entityId: entity.id, class: 'collision', data: new CollisionNode(entity.id, entity.collision, entity.display, entity.velocity) });\n        }\n    }\n\n    removeEntity(entity) {\n\n        let entityId = entity.id;\n\n        let index = this.entities.indexOf(entity);\n        if (index > -1) {\n            this.entities[index] = null;\n            this.entities.splice(index, 1);\n        }\n\n        var i = this.nodes.length;\n\n        while (i--) {\n            if (this.nodes[i].entityId === entityId) {\n                this.nodes[i] = null;\n                this.nodes.splice(i, 1);\n            }\n        }\n    }\n\n    addSystem(system) {\n\n        this.systems.push(system);\n\n        system.init();\n    }\n\n    removeSystem(system) {\n\n        let index = this.systems.indexOf(system);\n\n        if (index > -1) {\n            system.stop();\n            this.systems.splice(index, 1);\n        }\n    }\n\n    getNodes(nodeClass) {\n\n        let nodes = [];\n\n        for (var i = 0, j = this.nodes.length; i < j; i++) {\n\n            if (this.nodes[i].class === nodeClass) {\n                nodes.push(this.nodes[i]);\n            }\n        }\n\n        return nodes;\n    }\n\n    update(before = 0) {\n\n        this.isPaused = false;\n\n        // console.log(document.visibilityState);\n\n        if (document.visibilityState !== 'visible') {\n\n            this.isPaused = true;\n        }\n\n        let now = performance.now();\n\n            // console.log(now);\n\n            // console.log(before);\n\n        let dt = (now - before)/1000;\n\n        dt = Math.min(dt, 0.1); // magic number to prevent massive dt when tab not active\n\n        for (var i = 0, j = this.systems.length; i < j; i++) {\n\n            // console.log(dt);\n\n            if (!this.isPaused) {\n\n                this.systems[i].update(dt, this.getNodes(this.systems[i].class));\n            }\n        }\n\n        before = now;\n\n        requestAnimationFrame(this.update.bind(this, before));\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./assets/js/engine.js","export default class MoveNode {\n\n    constructor (entityId, positionComponent, velocityComponent) {\n        this.entityId = entityId;\n        this.position = positionComponent;\n        this.velocity = velocityComponent;\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./assets/js/nodes/move.js","export default class RenderNode {\n\n    constructor (entityId, displayComponent, positionComponent) {\n        this.entityId = entityId;\n        this.display = displayComponent;\n        this.position = positionComponent;\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./assets/js/nodes/render.js","export default class ControlNode {\n\n    constructor (entityId, inputComponent, velocityComponent) {\n        this.entityId = entityId;\n        this.input = inputComponent;\n        this.velocity = velocityComponent;\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./assets/js/nodes/control.js","export default class CollisionNode {\n\n    constructor (entityId, collisionComponent, displayComponent, velocityComponent) {\n        this.entityId = entityId;\n        this.collision = collisionComponent;\n        this.display = displayComponent;\n        this.velocity = velocityComponent;\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./assets/js/nodes/collision.js","export default class Entity {\n\n    constructor() {\n\n        this.id = this.generateUUID();\n        this.flag_kill = false;\n    }\n\n    generateUUID() {\n        var d = new Date().getTime();\n        if(window.performance && typeof window.performance.now === \"function\"){\n            d += performance.now(); //use high-precision timer if available\n        }\n        var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n            var r = (d + Math.random()*16)%16 | 0;\n            d = Math.floor(d/16);\n            return (c=='x' ? r : (r&0x3|0x8)).toString(16);\n        });\n        return uuid;\n    }\n\n    kill() {\n        this.flag_kill = true;\n    }\n\n    addComponent(component) {\n\n        this[component.class] = component;\n    }\n\n    removeComponent(componentClass) {\n\n        this[componentClass] = null;\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./assets/js/entity.js","export default class DisplayComponent {\n\n    constructor(data) {\n\n        this.class = 'display';\n\n        this.sprite = data.sprite;\n\n        this.isFocus = false;\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./assets/js/components/display.js","export default class PositionComponent {\n\n    constructor() {\n\n        this.class = 'position';\n\n        this.x = 0;\n        this.y = 0;\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./assets/js/components/position.js","export default class VelocityComponent {\n\n    constructor() {\n\n        this.class = 'velocity';\n\n        this.accelerationX = 0;\n        this.accelerationY = 0;\n\n        this.maxAccelerationX = 3;\n        this.maxAccelerationY = 4;\n\n        this.velocityX = 0;\n        this.velocityY = 0;\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./assets/js/components/velocity.js","export default class InputComponent {\n\n    constructor() {\n\n        this.class = 'input';\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./assets/js/components/input.js","export default class CollisionComponent {\n\n    constructor() {\n\n        this.class = 'collision';\n\n        this.type = '';\n\n        this.collide = () => {\n\n            // console.log('COLLIDE');\n        }\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./assets/js/components/collision.js","export default class MoveSystem {\n\n    constructor(settings) {\n\n        this.class = 'move';\n        this.settings = settings;\n    }\n\n    init() {\n\n    }\n\n    update(time, nodes) {\n\n        nodes.map((node) => {\n\n            let velocityData = node.data.velocity;\n\n            let positionData = node.data.position;\n\n            if (!velocityData.isGrounded) {\n                // limit horizontal movement in the air\n                velocityData.accelerationX = velocityData.accelerationX/3;\n            }\n\n            velocityData.velocityX = (velocityData.velocityX + time * velocityData.accelerationX) * this.settings.FRICTION;\n\n            if (velocityData.isGrounded) {\n                    // prevent any more downwards vertical movement\n                    velocityData.velocityY = Math.max(0, velocityData.velocityY);\n                    // round up to tile edge\n                    positionData.y = Math.floor(positionData.y/this.settings.TILE)*this.settings.TILE;\n\n            } else {\n\n                velocityData.velocityY = (velocityData.velocityY + time * velocityData.accelerationY);\n            }\n\n            positionData.x += (velocityData.velocityX + time * velocityData.velocityX) * this.settings.TILE;\n\n            // stop movement at map boundaries - shift this to collision system\n            positionData.x = Math.max(0, positionData.x);\n            positionData.x = Math.min(positionData.x, this.settings.MAP[0]*this.settings.TILE - this.settings.TILE);\n\n            // cap the velocity - anything more than 0.7 and the entity might fall\n            // though the tile before collision is detected\n            let velocityY = Math.min(velocityData.velocityY + time * velocityData.velocityY, 0.5);\n\n            positionData.y += velocityY * this.settings.TILE;\n\n            positionData.y = Math.max(0, positionData.y);\n\n        });\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./assets/js/systems/move.js","export default class RenderSystem {\n\n    constructor(settings) {\n\n        this.class = 'render';\n\n        this.sprites = {};\n\n        this.stage = {};\n\n        this.container = {};\n\n        this.settings = settings;\n    }\n\n    init() {\n\n        this.stage = new PIXI.Stage();\n\n        this.container = new PIXI.Container();\n\n        this.stage.addChild(this.container);\n\n        this.renderer = PIXI.autoDetectRenderer(640, 480);\n\n        this.stage.position.x = this.renderer.width/2; // 320\n        this.stage.position.y = this.renderer.height/2; // 240\n\n        document.body.appendChild(this.renderer.view);\n    }\n\n    update(time, nodes) {\n\n        // console.log('render update');\n\n        for (var i = 0, j = nodes.length; i < j; i++) {\n\n            let id = nodes[i].data.entityId;\n\n            if (!this.sprites.hasOwnProperty(id)) {\n\n                let sprite = nodes[i].data.display.sprite;\n\n                this.sprites[id] = sprite;\n\n                this.container.addChild(sprite);\n            }\n\n            // console.log(nodes[i].data.position);\n            // console.log(nodes[i].data.display);\n\n            nodes[i].data.display.sprite.position.x = nodes[i].data.position.x;\n            nodes[i].data.display.sprite.position.y = nodes[i].data.position.y;\n\n            if (nodes[i].data.display.isFocus) {\n\n                let x = nodes[i].data.display.sprite.x;\n                let width = nodes[i].data.display.sprite.width;\n                let y = nodes[i].data.display.sprite.y;\n                let height = nodes[i].data.display.sprite.height;\n\n\n                let mapWidth = this.settings.MAP[0] * this.settings.TILE;\n                let mapHeight = this.settings.MAP[1] * this.settings.TILE;\n\n                let screenWidth = this.renderer.width;\n                let screenHeight = this.renderer.height;\n\n                // console.log('mapWidth ', mapWidth);\n                // console.log('screenWidth ', screenWidth);\n\n                let pivotX = x < screenWidth/2 ? screenWidth/2 : x;\n                pivotX = x + screenWidth/2 > mapWidth ? mapWidth - screenWidth/2 : pivotX;\n\n                this.stage.pivot.x = pivotX;\n\n                // console.log(pivotX);\n\n                let pivotY = y < mapHeight/2 ? screenHeight/2 : y;\n                pivotY = y + screenHeight/2 > mapHeight ? mapHeight - screenHeight/2 : pivotY;\n\n                this.stage.pivot.y = pivotY;\n\n\n\n                // test against map width * tilesize\n                if (nodes[i].data.display.sprite.x < 0 ||\n                    nodes[i].data.display.sprite.x + nodes[i].data.display.sprite.width > mapWidth) {\n                    console.log('EXIT');\n                }\n\n                // console.log('x', this.stage.pivot.x);\n                // console.log('y', this.stage.pivot.y);\n            }\n        }\n\n        for (let id of Object.keys(this.sprites)) {\n            if (!this.sprites[id]) {\n                delete this.sprites[id];\n            }\n        }\n\n        this.renderer.render(this.stage);\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./assets/js/systems/render.js","export default class ControlSystem {\n\n    constructor(settings) {\n\n        this.class = 'control';\n        this.settings = settings;\n    }\n\n    onKeyDown(e) {\n\n        let key = e.keyCode;\n\n        this.isJump = this.isJump | key === this.settings.KEY.SPACE;\n        this.isLeft = this.isLeft | key === this.settings.KEY.LEFT;\n        this.isUp = this.isUp | key === this.settings.KEY.UP;\n        this.isRight = this.isRight | key === this.settings.KEY.RIGHT;\n        this.isDown = this.isDown | key === this.settings.KEY.DOWN;\n    }\n\n    onKeyUp(e) {\n\n        let key = e.keyCode;\n\n        this.isJump = key === this.settings.KEY.SPACE ? false : this.isJump;\n        this.isLeft = key === this.settings.KEY.LEFT ? false : this.isLeft;\n        this.isUp = key === this.settings.KEY.UP ? false : this.isUp;\n        this.isRight = key === this.settings.KEY.RIGHT ? false : this.isRight;\n        this.isDown = key === this.settings.KEY.DOWN ? false : this.isDown;\n    }\n\n    bind() {\n        window.addEventListener('keydown', this.onKeyDown.bind(this), false);\n        window.addEventListener('keyup', this.onKeyUp.bind(this), false);\n    }\n\n    unbind() {\n        window.removeEventListener('keydown', this.onKeyDown.bind(this), false);\n        window.removeEventListener('keyup', this.onKeyUp.bind(this), false);\n    }\n\n    init() {\n        this.bind();\n    }\n\n    update(time, nodes) {\n\n        for (var i = 0, j = nodes.length; i < j; i++) {\n\n            if (this.isUp && nodes[i].data.velocity.isGrounded) {\n                console.log('JUMP');\n                nodes[i].data.velocity.accelerationY = -nodes[i].data.velocity.maxAccelerationY;\n                nodes[i].data.velocity.velocityY = -0.3;\n            } else {\n                nodes[i].data.velocity.accelerationY = 1;\n            }\n\n            if (this.isRight) {\n                // console.log('right');\n                nodes[i].data.velocity.accelerationX = nodes[i].data.velocity.maxAccelerationX;\n            } else if (this.isLeft) {\n                // console.log('left');\n                nodes[i].data.velocity.accelerationX = -nodes[i].data.velocity.maxAccelerationX;\n            } else {\n                nodes[i].data.velocity.accelerationX = 0;\n            }\n        }\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./assets/js/systems/control.js","export default class CollisionSystem {\n\n    constructor(settings) {\n\n        this.class = 'collision';\n        this.settings = settings;\n    }\n\n    init() {\n\n    }\n\n    isCollision(sprite1, sprite2) {\n\n        let isCollision = false;\n\n        if (sprite1.x < sprite2.x + sprite2.width &&\n           sprite1.x + sprite1.width > sprite2.x &&\n           sprite1.y < sprite2.y + sprite2.height &&\n           sprite1.height + sprite1.y > sprite2.y) {\n            isCollision = true;\n        }\n\n        return isCollision;\n    }\n\n    update(time, nodes) {\n\n        let primaries = nodes.filter((node) => {\n\n            return node.data.collision.type === 'primary';\n        });\n\n        let secondaries = nodes.filter((node) => {\n\n            return node.data.collision.type !== 'primary';\n        });\n\n        primaries.map((primary) => {\n\n            primary.data.velocity.isGrounded = false;\n\n            secondaries.map((secondary) => {\n\n                let sprite1 = primary.data.display.sprite;\n\n                let sprite2 = secondary.data.display.sprite;\n\n                if (this.isCollision(sprite1, sprite2)) {\n\n                    let velocityData = primary.data.velocity;\n\n                    let errorMargin = this.settings.TILE/2;\n\n                    let isBottomCollision = sprite1.y + sprite1.height > sprite2.y &&\n                        sprite1.height + sprite1.y < sprite2.y + errorMargin;\n\n                    let isTopCollision = sprite2.y + sprite2.height > sprite1.y &&\n                        sprite2.height + sprite2.y < sprite1.y + errorMargin;\n\n                    let isRightCollision = sprite1.x + sprite1.width > sprite2.x &&\n                        sprite1.x + sprite1.width < sprite2.x + errorMargin;\n\n                    let isLeftCollision = sprite2.x + sprite2.width > sprite1.x &&\n                        sprite2.x + sprite2.width < sprite1.x + errorMargin;\n\n                    // check collision\n                    if (isBottomCollision) {\n\n                        // velocityData.accelerationY = Math.min(0, velocityData.accelerationY);\n                        velocityData.velocityY = Math.min(0, velocityData.velocityY);\n\n                        velocityData.isGrounded = true;\n\n                    } else if (isTopCollision) {\n\n                        // velocityData.accelerationY = Math.max(0, velocityData.accelerationY);\n                        velocityData.velocityY = Math.max(0, velocityData.velocityY);\n\n                    } else if (isRightCollision) {\n\n                        velocityData.accelerationX = Math.min(0, velocityData.accelerationX);\n                        velocityData.velocityX = Math.min(0, velocityData.velocityX);\n\n                    } else if (isLeftCollision) {\n\n                        velocityData.accelerationX = Math.max(0, velocityData.accelerationX);\n                        velocityData.velocityX = Math.max(0, velocityData.velocityX);\n                    }\n\n                    primary.data.collision.collide(secondary);\n                }\n            });\n        });\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./assets/js/systems/collision.js","export default class PlayerData {\n\n    constructor() {\n\n        let texture = PIXI.utils.TextureCache['/static/img/player.png'];\n\n        this.sprite = new PIXI.Sprite(texture);\n\n        this.sprite.data = {};\n\n        this.sprite.data.texture = [];\n\n        this.sprite.data.texture.push(new PIXI.Rectangle(0, 0, 16, 32));\n        this.sprite.data.texture.push(new PIXI.Rectangle(16, 0, 16, 32));\n        this.sprite.data.texture.push(new PIXI.Rectangle(32, 0, 16, 32));\n        this.sprite.data.texture.push(new PIXI.Rectangle(48, 0, 16, 32));\n\n        texture.frame = this.sprite.data.texture[1];\n\n        this.sprite.data.animation = {\n            walkLeft : [2, 1],\n            walkRight: [1, 2],\n            jump: [3],\n            default: [0]\n        }\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./assets/js/data/player.js","export default class SettingsData {\n\n    constructor() {\n\n        this.GRAVITY = 1;\n        this.FRICTION = 0.90;\n        this.TILE = 16;\n        this.MAP = [45, 30];\n        this.KEY = { SPACE: 32, LEFT: 37, UP: 38, RIGHT: 39, DOWN: 40 };\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./assets/js/data/settings.js","export default class MapData {\n\n    constructor() {\n\n        this.sprite = this.getSprite();\n\n        this.levels = [];\n\n        this.levels.push({\n            url: '/assets/json/levelone.json',\n            start: [3, 3]\n        });\n\n        this.currentLevel = 1;\n\n        this.level = this.getData();\n    }\n\n    getSprite() {\n\n        let texture = new PIXI.Texture(PIXI.utils.TextureCache['bg'], new PIXI.Rectangle(32, 0, 16, 16));\n\n        return new PIXI.Sprite(texture);\n    }\n\n    getData() {\n\n        let levelData = this.levels[this.currentLevel - 1];\n\n        return fetch(levelData.url)\n        .then((response) => {\n            return response.json();\n        })\n        .then((data) => {\n            levelData.data = data;\n            return levelData;\n        });\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./assets/js/data/map.js","export default class AnimationComponent {\n\n    constructor(data) {\n\n        this.class = 'animation';\n\n        this.default = [0];\n\n        this.walkRight = [1, 2];\n\n        this.walkLeft = [2, 1];\n\n        this.jump = [3];\n\n        this.currentAnimationProp = 'default';\n\n        this.currentFrame = 0;\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./assets/js/components/animation.js","export default class AnimationSystem {\n\n    constructor(settings) {\n\n        this.class = 'animation';\n        this.settings = settings;\n        this.timer = 0;\n    }\n\n    init() {\n\n    }\n\n    setAnimation(node, prop) {\n\n        node.data.animation.currentAnimationProp = prop;\n    }\n\n    updateFrame(node) {\n\n        let animationData = node.data.animation;\n\n        let displayData = node.data.display;\n\n        let frames = animationData[node.data.animation.currentAnimationProp];\n\n        if (animationData.currentFrame + 1 >= frames.length) {\n\n            animationData.currentFrame = 0;\n\n        } else {\n\n            animationData.currentFrame++;\n        }\n\n        displayData.sprite.texture.frame = displayData.sprite.data.texture[frames[animationData.currentFrame]];\n    }\n\n    update(dt, nodes) {\n\n        nodes.map((node) => {\n\n            let velocityData = node.data.velocity;\n\n            let animationData = node.data.animation;\n\n            if (velocityData.velocityY > 0.01 || velocityData.velocityY < -0.01) {\n\n                // play jump animation\n                this.setAnimation(node, 'jump');\n\n            } else if (velocityData.velocityX > 0.1) {\n\n                //play right animation\n                this.setAnimation(node, 'walkRight');\n\n            } else if (velocityData.velocityX < -0.1) {\n\n                //play left animation\n                this.setAnimation(node, 'walkLeft');\n\n            } else {\n\n                this.setAnimation(node, 'default');\n            }\n\n            this.timer = this.timer + dt;\n\n            if (this.timer > 0.2) {\n\n                this.updateFrame(node);\n\n                this.timer = dt;\n            }\n        });\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./assets/js/systems/animation.js","export default class AnimationNode {\n\n    constructor (entityId, animationComponent, displayComponent, velocityComponent) {\n        this.entityId = entityId;\n        this.animation = animationComponent;\n        this.display = displayComponent;\n        this.velocity = velocityComponent;\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./assets/js/nodes/animation.js"],"sourceRoot":""}